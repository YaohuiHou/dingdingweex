{"version":3,"file":"journey-min.js","sources":["../package/dingtalk-querystring/index.js","../package/dingtalk-url/index.js","../package/dingtalk-env/index.js","../package/dingtalk-version/index.js","../package/dingtalk-require/index.js","../package/dingtalk-document/index.js","../package/dingtalk-timer/index.js"],"sourcesContent":["\nfunction parse(qs, sep, eq){\n  const obj = Object.create(null);\n  if (typeof qs !== 'string' || qs.length === 0 ){\n    return obj;\n  }\n  sep = sep || '&';\n  eq = eq || '=';\n  const params = qs.split(sep);\n  let i = 0;\n  let l = params.length;\n  for(;i<l;i++){\n    let items = params[i].split(eq);\n    let queryKey = items[0].trim();\n    let queryVal = '';\n    if (items.length >= 3){\n      items.splice(0,1);\n      let lastIndex = items.length - 1;\n      items.forEach(function(v,i){\n        v = v.trim();\n        if (i === lastIndex){\n          queryVal += v;\n        } else {\n          queryVal += v + eq\n        }\n      });\n    } else {\n      queryVal = items[1].trim();\n    }\n    let cur = obj[queryKey];\n    if (cur){\n      if (Array.isArray(cur)){\n        cur.push(queryVal);\n      } else {\n        let temp = cur;\n        obj[queryKey] = new Array();\n        obj[queryKey].push(temp);\n        obj[queryKey].push(queryVal);\n      }\n    } else {\n      obj[queryKey] = queryVal;\n    }\n  }\n  return obj;\n}\n\nfunction stringify(obj, sep, eq){\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj !== null && typeof obj === 'object'){\n    const keys = Object.keys(obj);\n    const len = keys.length;\n    const flast = len - 1;\n    let fields = '';\n    let i = 0;\n    for (;i<len; i++){\n      let k = keys[i];\n      let v = obj[k];\n      let ks = k + eq;\n      if (Array.isArray(v)){\n        let vlen = v.length;\n        let vlast = vlen - 1;\n        let j = 0;\n        for (; j < vlen; ++j) {\n           fields += ks + v[j];\n           if (j < vlast){\n             fields += sep;\n           }\n        }\n        if (vlen && i < flast){\n          fields += sep;\n        }\n      } else {\n        fields += ks + v;\n        if (i < flast){\n          fields += sep;\n        }\n      }\n    }\n    return fields;\n  }\n  return '';\n}\n\nexport default {\n  stringify,\n  parse\n};\n","import querystring from 'dingtalk-querystring';\n\nfunction format(url, query){\n  let search = querystring.stringify(query);\n  return url + '?' + search;\n}\n\nfunction parse(url,parseQueryString){\n  let location = {\n    hash: null,\n    search: null\n  };\n  if (!url){\n    return {};\n  }\n  const searchIndex = url.indexOf('?');\n  if (searchIndex === -1){\n    return {};\n  }\n  const hashIndex = url.indexOf('#');\n  if (hashIndex > -1){\n    location.hash = url.slice(hashIndex);\n    location.search = url.slice(searchIndex, hashIndex);\n  } else {\n    location.search = url.slice(searchIndex);\n  }\n  const searchString = location.search.slice(1);\n  const query = querystring.parse(searchString);\n  if (typeof parseQueryString === 'string' && parseQueryString.length > 0){\n    return query[parseQueryString];\n  } else {\n    return query;\n  }\n}\n\nexport default {\n  format,\n  parse\n}\n","import url from 'dingtalk-url';\n\nfunction whatEnv(){\n  /*\n    env Object ======= !!!!\n\n    platform,\n    bundleFrameworkType,\n    dingtalk {\n     bundleUrl,\n     originalUrl\n    }\n    appName\n\n   */\n  let weexEnv = {};\n  if (typeof weex !== 'undefined'){\n    const config = weex.config;\n    const env = config.env;\n    weexEnv.platform = env.platform;\n    weexEnv.bundleFrameworkType = 'Vue';\n    if (weexEnv.platform !== 'Web'){\n      weexEnv.dingtalk = {\n        bundleUrl: config.bundleUrl,\n        originalUrl: config.originalUrl\n      };\n      weexEnv.appVersion = env.appVersion;\n      weexEnv.appName = env.appName;\n    } else {\n      // Vue Web\n      const href = location.href;\n      const tpl = url.parse(href,'dd_wx_tpl');\n      const _wx_tpl = url.parse(href,'_wx_tpl');\n      weexEnv.dingtalk = {\n        bundleUrl: tpl ? tpl : _wx_tpl ? _wx_tpl : '',\n        originalUrl: href\n      }\n    }\n  } else {\n    // Rax Weex\n    if (typeof callNative === 'function'){\n      weexEnv.platform = navigator.platform;\n      weexEnv.appName = navigator.appName;\n      weexEnv.appVersion = navigator.appVersion;\n      weexEnv.dingtalk = {\n        bundleUrl: __weex_options__.bundleUrl,\n        originalUrl: __weex_options__.originalUrl\n      };\n    } else {\n      // Rax Web\n      weexEnv.platform = 'Web';\n      const href = location.href;\n      const tpl = url.parse(href,'dd_wx_tpl');\n      const _wx_tpl = url.parse(href,'_wx_tpl');\n      weexEnv.dingtalk = {\n        bundleUrl: tpl ? tpl : _wx_tpl ? _wx_tpl : '',\n        originalUrl: href\n      }\n    }\n    weexEnv.bundleFrameworkType = 'Rax';\n  }\n  return weexEnv;\n}\n\nconst env = whatEnv();\nconst isWeb = env.platform === 'Web';\nconst isWeexiOS = env.platform === 'iOS';\nconst isWeexAndroid = env.platform === 'android';\nconst isWeex = isWeexiOS || isWeexAndroid;\nconst { dingtalk, bundleFrameworkType } = env;\nconst { bundleUrl, originalUrl } = dingtalk;\n\nlet UA;\nif(isWeb){\n  UA = window.navigator.userAgent.toLowerCase();\n}\n\nconst isDingtalk = dingtalkContainer();\n\nfunction dingtalkContainer(){\n  if (isWeex){\n    if (env.appName === 'DingTalk' || env.appName === 'com.alibaba.android.rimet'){\n      return true;\n    }\n    return false;\n  } else {\n    return UA && UA.indexOf('dingtalk') > -1;\n  }\n}\n\nfunction webAndroid(){\n  if (isWeb){\n    return UA && UA.indexOf('android') > -1;\n  }\n  return null;\n}\n\nfunction webiOS(){\n  if (isWeb){\n    return UA && /iphone|ipad|ipod|ios/.test(UA);\n  }\n  return null;\n}\n\nfunction fetchVersion(){\n  if (isWeb){\n    let matches = UA.match(/aliapp\\(\\w+\\/([a-zA-Z0-9.-]+)\\)/);\n    if (matches === null) {\n        matches = UA.match(/dingtalk\\/([a-zA-Z0-9.-]+)/);\n    }\n    let version = matches && matches[1];\n    return version;\n  } else {\n    return env.appVersion;\n  }\n}\n\nconst isWebiOS = webiOS();\nconst isWebAndroid = webAndroid();\nconst version = fetchVersion();\n\nexport default {\n  isDingtalk,\n  isWeb,\n  isWebiOS,\n  isWebAndroid,\n  isWeex,\n  isWeexiOS,\n  isWeexAndroid,\n  bundleFrameworkType,\n  bundleUrl,\n  originalUrl,\n  version\n};\n","\nexport default function compareVersion (oldVersion, newVersion, containEqual){\n  if (typeof oldVersion !== 'string' || typeof newVersion !== 'string') {\n    return false;\n  }\n  //分割字符串为['1', '0', '1']格式\n  let oldArray = oldVersion.split('.');\n  let newArray = newVersion.split('.');\n  let o;\n  let n;\n  do {\n    o = oldArray.shift();\n    n = newArray.shift();\n  } while (o === n && newArray.length > 0);\n  if (containEqual) {\n    return (n | 0) >= (o | 0);\n  } else {\n    return (n | 0) > (o | 0);\n  }\n}\n","import env from 'dingtalk-env';\n\nconst { bundleFrameworkType,isWeex } = env;\n\nexport default function requireModule(name){\n  if (isWeex){\n    if (bundleFrameworkType === 'Vue'){\n      return weex.requireModule(name);\n    } else {\n      let moduleName = '@weex-module/' + name;\n      return __weex_require__(moduleName);\n    }\n  } else {\n    if (bundleFrameworkType === 'Vue'){\n      return weex.requireModule(name);\n    }\n  }\n}\n","import env from 'dingtalk-env';\n\nconst { bundleFrameworkType, isWeex} = env;\n\nfunction Document(){\n  if ( isWeex && bundleFrameworkType === 'Vue'){\n    return weex.document;\n  } else {\n    return document;\n  }\n}\n\nconst doc = Document();\n\nexport default doc;\n","import requireModule from 'dingtalk-require';\nimport document from 'dingtalk-document';\nimport env from 'dingtalk-env';\n\nconst timer = requireModule('timer');\nconst { isWeex } = env;\n\nfunction setTimeout(handler,time){\n  if (isWeex){\n    timer.setTimeout(handler,time);\n    return document.taskCenter.callbackManager.lastCallbackId.toString();\n  } else {\n    return window.setTimeout(handler,time);\n  }\n}\n\nfunction clearTimeout(n){\n  if (isWeex){\n    timer.clearTimeout(n);\n  } else {\n    window.clearTimeout(n);\n  }\n}\n\nfunction setInterval(handler,time){\n  if (isWeex){\n    timer.setInterval(handler,time);\n    return document.taskCenter.callbackManager.lastCallbackId.toString();\n  } else {\n    return window.setInterval(handler,time);\n  }\n}\n\nfunction clearInterva(n){\n  if (isWeex){\n    timer.clearInterva(n);\n  } else {\n    window.clearInterva(n);\n  }\n}\n\nexport default {\n  setTimeout,\n  clearTimeout,\n  setInterval,\n  clearInterva\n};\n"],"names":["parse","qs","sep","eq","obj","Object","create","length","params","split","i","l","items","queryKey","trim","queryVal","splice","lastIndex","forEach","v","cur","Array","isArray","push","temp","stringify","keys","len","flast","fields","k","ks","vlen","vlast","j","format","url","query","querystring","parseQueryString","location","searchIndex","indexOf","hashIndex","hash","slice","search","searchString","whatEnv","weexEnv","weex","config","env","platform","bundleFrameworkType","dingtalk","bundleUrl","originalUrl","appVersion","appName","href","tpl","_wx_tpl","callNative","navigator","__weex_options__","dingtalkContainer","isWeex","UA","webAndroid","isWeb","webiOS","test","fetchVersion","matches","match","compareVersion","oldVersion","newVersion","containEqual","oldArray","newArray","o","n","shift","requireModule","name","moduleName","__weex_require__","Document","document","setTimeout","handler","time","taskCenter","callbackManager","lastCallbackId","toString","window","clearTimeout","setInterval","clearInterva","isWeexiOS","isWeexAndroid","userAgent","toLowerCase","isDingtalk","isWebiOS","isWebAndroid","version","doc","timer"],"mappings":"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"}